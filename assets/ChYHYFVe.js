import{_ as V,r as c,f as T,c as m,o as f,g as Y,a,d as N,t as y,e as q,k as b,B as Q,F as I,h as D,q as j,V as ie,j as J,w as le,Q as ae,T as re,l as ue,W as ce,b as S,X as K}from"./DoE3vVx7.js";const de={key:0,class:"info-box"},ve=["src"],pe={__name:"unit",props:{unit:{type:Object,required:!0}},setup(t){const d=t,s=c(!1),r=()=>s.value=!s.value,g=T(()=>{switch(d.unit.state){case"searching":return"Ich halte Ausschau nach Arbeit.";case"movingTo":return"Ich mache mich auf den Weg.";case"mining":return"Ich arbeite hart an der Ressource.";case"returning":return"Ich bringe die Ressource nach Hause.";default:return"Ich existiere."}});return(i,o)=>(f(),m("div",{class:"unit",style:b({left:t.unit.x+"px",top:t.unit.y+"px"}),onClick:q(r,["stop"])},[s.value?(f(),m("div",de,[t.unit.picture?(f(),m("img",{key:0,src:t.unit.picture,alt:"Unit Picture"},null,8,ve)):Y("",!0),o[0]||(o[0]=a("br",null,null,-1)),a("strong",null,y(t.unit.name),1),o[1]||(o[1]=a("br",null,null,-1)),o[2]||(o[2]=N(" Aufgabe: Resourcen ")),o[3]||(o[3]=a("br",null,null,-1)),N(" Alter: "+y(t.unit.age),1),o[4]||(o[4]=a("br",null,null,-1)),a("em",null,y(g.value),1)])):Y("",!0)],4))}},fe=V(pe,[["__scopeId","data-v-5762b9b6"]]),ge={class:"minimap-fixed"},me={__name:"minimap",props:["colony","resources","units","mapWidth","mapHeight"],setup(t){const d=t,s=c(0),r=c(0);function g(n){return!n||!d.mapWidth||!d.mapHeight?{}:{left:n.x/d.mapWidth*100+"%",top:n.y/d.mapHeight*100+"%"}}const i=T(()=>{const n=window.innerWidth,v=window.innerHeight;return{position:"absolute",left:s.value/d.mapWidth*100+"%",top:r.value/d.mapHeight*100+"%",width:n/d.mapWidth*100+"%",height:v/d.mapHeight*100+"%",border:"2px dashed blue",pointerEvents:"none"}});function o(){s.value=window.scrollX,r.value=window.scrollY}return window.addEventListener("scroll",o),Q(()=>{window.removeEventListener("scroll",o)}),(n,v)=>(f(),m("div",ge,[a("div",{class:"minimap-colony",style:b(g(t.colony))},null,4),(f(!0),m(I,null,D(t.resources,w=>(f(),m("div",{key:"m"+w.id,class:"minimap-resource",style:b(g(w))},null,4))),128)),(f(!0),m(I,null,D(t.units,w=>(f(),m("div",{key:"u"+w.id,class:"minimap-unit",style:b(g(w))},null,4))),128)),a("div",{class:"viewport",style:b(i.value)},null,4)]))}},we=V(me,[["__scopeId","data-v-3c11ebe5"]]),he={__name:"dragwindowfunction",props:["WindowPos","isFixed","dragWindowPos"],emits:["update:positionViewport"],setup(t,{emit:d}){const s=d,r=t,g=c(null),i=c(null),o=c({x:r.WindowPos.x,y:r.WindowPos.y});let n=!1,v={x:0,y:0};const w=c(!1);function W(l){n=!0,r.isFixed?(console.log("fixed startdrag"),v.x=l.clientX/window.innerWidth*100-i.x,v.y=l.clientY/window.innerHeight*100-i.y,window.addEventListener("mousemove",M)):(console.log("NON fixed startdrag"),v.x=l.clientX-o.value.x,v.y=l.clientY-o.value.y,window.addEventListener("mousemove",M))}function C(){n=!1,console.log("stopdrag"),window.removeEventListener("mousemove",M),u()}function M(l){console.log("is draggingggggg"),n&&(r.isFixed?(console.log("fixed"),i.x=l.clientX/window.innerWidth*100-v.x,i.y=l.clientY/window.innerHeight*100-v.y,s("update:positionViewport",i)):(o.value.x=l.clientX-v.x,o.value.y=l.clientY-v.y,console.log("non fixed"),console.log("isFixed var: "+r.isFixed)))}function u(){if(g.value){const l=g.value.getBoundingClientRect();i.value={x:l.left/window.innerWidth*100,y:l.top/window.innerHeight*100},s("update:positionViewport",i),console.log("Viewport Menu: x "+i.value.x+" und y "+i.value.y)}else console.error("dragWindowPos.value is null")}return j(()=>{u()}),(l,$)=>(f(),m("div",{ref_key:"dragWindowPos",ref:g,class:"draggable-window no-select",style:b({left:w.value?i.value.x+"vw":o.value.x+"px",top:w.value?i.value.y+"vh":o.value.y+"px"}),onMousedown:W,onMouseup:C},[a("div",{onMousedown:q(W,["stop"])},[ie(l.$slots,"default",{},void 0)],32)],36))}},xe=V(he,[["__scopeId","data-v-9ad92154"]]),ye={style:{"margin-top":"10px"}},Me=["max"],be={__name:"colonymenu",props:["showMenu","collected","credits","price","colony"],emits:["update:credits","update:collected","update:showMenu"],setup(t,{emit:d}){const s=t,r=d,g=c(1),i=c(!1),o=c(null),n=c({x:50,y:30});function v(){const u=s.collected*s.price;r("update:credits",s.credits+u),r("update:collected",0)}function w(){const u=Math.min(g.value,s.collected);r("update:credits",s.credits+u*s.price),r("update:collected",s.collected-u)}function W(){r("update:showMenu",!1)}function C(){i.value=!i.value,console.log("Fixmode: ",i.value)}function M(u){console.log("Viewport 2 Menu:"),u&&u.value?(n.value.x=u.value.x,n.value.y=u.value.y,console.log("Viewport 2 Menu: x "+n.value.x+" und y "+n.value.y)):console.error("newpositionViewport is not defined or does not have value")}return(u,l)=>(f(),m(I,null,[l[2]||(l[2]=N(" //fixed window sichern durch scroll-move-abfrage und dadurch neue positionen ")),t.showMenu?(f(),J(xe,{key:0,WindowPos:t.colony,isFixed:i.value,dragWindowPos:o.value,"onUpdate:positionViewport":M},{default:le(()=>[t.showMenu?(f(),m("div",{key:0,ref_key:"dragWindowPosRef",ref:o,class:"menu",style:b({left:i.value?n.value.x+"vw":t.colony.x+"px",top:i.value?n.value.y+"vh":t.colony.y+"px",position:i.value?"fixed":"unset"})},[a("span",null,[l[1]||(l[1]=a("h3",null,"Kolonie-MenÃ¼",-1)),a("div",{class:"menu-buttons"},[a("button",{onClick:C},"ðŸ“Œ"),a("button",{onClick:W},"X")]),a("p",null,"Gesammelte Ressourcen: "+y(t.collected),1),a("p",null,"Guthaben: "+y(t.credits)+" Credits",1),a("div",null,[a("button",{onClick:v},"Alle verkaufen ("+y(t.collected)+" Ã— "+y(t.price)+" = "+y(t.collected*t.price)+")",1)]),a("div",ye,[ae(a("input",{"onUpdate:modelValue":l[0]||(l[0]=$=>g.value=$),type:"number",min:"1",max:t.collected,placeholder:"Menge"},null,8,Me),[[re,g.value,void 0,{number:!0}]]),a("button",{onClick:w},"Verkaufen")])])],4)):Y("",!0)]),_:1},8,["WindowPos","isFixed","dragWindowPos"])):Y("",!0)],64))}},We=V(be,[["__scopeId","data-v-ffcf12c9"]]),ke={class:"cursor-position"},Ce={__name:"positioncuros",props:["parentContainer"],setup(t){const d=t,s=c(0),r=c(0),g=n=>{if(d.parentContainer){const v=d.parentContainer.getBoundingClientRect();s.value=n.clientX-v.left,r.value=n.clientY-v.top}},i=T(()=>{var n;return s.value/((n=d.parentContainer)==null?void 0:n.offsetWidth)*100}),o=T(()=>{var n;return r.value/((n=d.parentContainer)==null?void 0:n.offsetHeight)*100});return j(()=>{window.addEventListener("mousemove",g)}),Q(()=>{window.removeEventListener("mousemove",g)}),(n,v)=>(f(),m("div",ke,[v[0]||(v[0]=a("p",null,"Cursor Position:",-1)),a("p",null,"X: "+y(s.value)+" px ("+y(i.value)+" vw)",1),a("p",null,"Y: "+y(r.value)+" px ("+y(o.value)+" vh)",1)]))}},Pe=V(Ce,[["__scopeId","data-v-28502bb9"]]),Xe={key:0},He={class:"hud"},Ie={__name:"colony",setup(t){const d=c(null),s=750*window.innerWidth/100,r=500*window.innerHeight/100,g=c(5),i=c(0),o=c(2e3),n=c(3e3),v=c(10),w=c(5),W=c(0),C=c(0),M=c(!1),u={x:s/2,y:r/2},l={left:u.x+"px",top:u.y+"px"};function $(){M.value=!M.value}function Z(e){i.value=e}function ee(e){w.value=e}let U=0;const P=c([]),k=c([]);function O(){return{id:U++,x:Math.random()*s,y:Math.random()*r,taken:!1}}for(let e=0;e<100;e++)P.value.push(O());function z(e,F){return Math.sqrt((e.x-F.x)**2+(e.y-F.y)**2)}async function te(){const e=v.value,h=await(await fetch(`https://randomuser.me/api?nat=DE&results=${e}`)).json();if(h.results&&Array.isArray(h.results))for(let H=0;H<h.results.length;H++){const p=h.results[H];if(p.name&&p.dob&&p.picture){const x=K({id:U++,x:u.x,y:u.y,vx:0,vy:0,target:null,state:"searching",arrived:!0,name:`${p.name.first} ${p.name.last}`,age:p.dob.age,picture:p.picture.large});k.value.push(x),A(x)}else console.error("Fehlende Daten fÃ¼r einen Unit:",p)}else console.error("Die API gibt keine Ergebnisse zurÃ¼ck oder die Antwort ist kein Array.")}function G(){if(k.value.length>=v.value)return;const e=K({id:U++,x:u.x,y:u.y,vx:0,vy:0,target:null,state:"searching",arrived:!0,name:names[Math.floor(Math.random()*names.length)],age:Math.floor(20+Math.random()*20)});k.value.push(e),A(e)}function A(e){function h(p,x){const X=p.x-e.x,L=p.y-e.y,B=Math.sqrt(X*X+L*L);if(B<1.2){e.x=p.x,e.y=p.y,x();return}e.vx=X/B*1.2,e.vy=L/B*1.2,e.x+=e.vx,e.y+=e.vy,requestAnimationFrame(()=>h(p,x))}function H(){if(e.state==="searching"){const p=P.value.filter(x=>!x.taken);if(p.length===0)return;p.sort((x,X)=>z(e,x)-z(e,X)),e.target=p[0],e.target.taken=!0,e.state="movingTo",h(e.target,()=>{e.state="mining",setTimeout(()=>{const x=P.value.findIndex(X=>X.id===e.target.id);x!==-1&&P.value.splice(x,1),P.value.push(O()),e.state="returning",H()},n.value)})}else e.state==="returning"&&h(u,()=>{w.value++;const p=k.value.findIndex(x=>x.id===e.id);p!==-1&&k.value.splice(p,1),setTimeout(()=>{e.state="searching",k.value.push(e),A(e)},o.value)})}H()}j(async()=>{await te(),ue(()=>{W.value=window.innerWidth/2-l.left,C.value=window.innerHeight/2-l.top,window.scrollTo({top:r/2-window.innerHeight/2,left:s/2-window.innerWidth/2,behavior:"smooth"}),console.log("X: "+u.x+" und Y:"+u.y),console.log("TOP: "+l.top+" und LEFT:"+l.left)}),ce(G,o.value)});let E=!1,R,_;function ne(e){E=!0,R=e.clientX,_=e.clientY}function oe(){E=!1}function se(e){E&&(W.value+=e.clientX-R,C.value+=e.clientY-_,R=e.clientX,_=e.clientY)}return(e,F)=>(f(),m(I,null,[S(Pe,{parentContainer:d.value},null,8,["parentContainer"]),a("div",{ref_key:"mapParentRef",ref:d,class:"game-world no-select",onMousedown:ne,onMouseup:oe,onMousemove:se,style:b({transform:`translate(${W.value}px, ${C.value}px)`,height:r+"px",width:s+"px"})},[a("div",{class:"colony",style:l,onClick:q($,["stop"])}),(f(!0),m(I,null,D(P.value,h=>(f(),m("div",{key:h.id,class:"resource",style:b({left:h.x+"px",top:h.y+"px"})},null,4))),128)),G?(f(),m("span",Xe,[(f(!0),m(I,null,D(k.value,h=>(f(),J(fe,{key:h.id,unit:h,job:e.job},null,8,["unit","job"]))),128))])):Y("",!0)],36),S(we,{colony:u,resources:P.value,units:k.value,mapWidth:s,mapHeight:r},null,8,["resources","units"]),S(We,{showMenu:M.value,collected:w.value,credits:i.value,price:g.value,colony:u,"onUpdate:credits":Z,"onUpdate:collected":ee,"onUpdate:showMenu":$},null,8,["showMenu","collected","credits","price"]),a("div",He," Ressourcen gesammelt: "+y(w.value),1)],64))}},$e=V(Ie,[["__scopeId","data-v-59b09d4c"]]);export{$e as default};
