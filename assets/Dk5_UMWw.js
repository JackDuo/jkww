import{_ as $,r as m,f as ee,c as v,o as c,g as q,a as o,d as te,t as y,e as E,k,F as D,h as C,V as ne,j as L,w as se,Q as ae,T as le,q as oe,l as ie,W as ce,b as F,X as N}from"./D1Jb8OLg.js";const ue={key:0,class:"info-box"},re=["src"],de={__name:"unit",props:{unit:{type:Object,required:!0}},setup(t){const a=t,n=m(!1),l=()=>n.value=!n.value,f=ee(()=>{switch(a.unit.state){case"searching":return"Ich halte Ausschau nach Arbeit.";case"movingTo":return"Ich mache mich auf den Weg.";case"mining":return"Ich arbeite hart an der Ressource.";case"returning":return"Ich bringe die Ressource nach Hause.";default:return"Ich existiere."}});return(r,p)=>(c(),v("div",{class:"unit",style:k({left:t.unit.x+"px",top:t.unit.y+"px"}),onClick:E(l,["stop"])},[n.value?(c(),v("div",ue,[o("strong",null,y(t.unit.name),1),p[0]||(p[0]=o("br",null,null,-1)),te(" Alter: "+y(t.unit.age),1),p[1]||(p[1]=o("br",null,null,-1)),t.unit.picture?(c(),v("img",{key:0,src:t.unit.picture,alt:"Unit Picture",style:{width:"50px",height:"auto"}},null,8,re)):q("",!0),p[2]||(p[2]=o("br",null,null,-1)),o("em",null,y(f.value),1)])):q("",!0)],4))}},me=$(de,[["__scopeId","data-v-855d063d"]]),ve={class:"minimap-fixed"},pe={__name:"minimap",props:["colony","resources","units","mapWidth","mapHeight"],setup(t){const a=t;function n(l){return!l||!a.mapWidth||!a.mapHeight?{}:{left:l.x/a.mapWidth*100+"%",top:l.y/a.mapHeight*100+"%"}}return(l,f)=>(c(),v("div",ve,[o("div",{class:"minimap-colony",style:k(n(t.colony))},null,4),(c(!0),v(D,null,C(t.resources,r=>(c(),v("div",{key:"m"+r.id,class:"minimap-resource",style:k(n(r))},null,4))),128)),(c(!0),v(D,null,C(t.units,r=>(c(),v("div",{key:"u"+r.id,class:"minimap-unit",style:k(n(r))},null,4))),128))]))}},fe=$(pe,[["__scopeId","data-v-2b45f12a"]]),he={__name:"dragwindowfunction",setup(t){const a=m({x:100,y:100});let n=!1,l={x:0,y:0};function f(i){n=!0,l.x=i.clientX-a.value.x,l.y=i.clientY-a.value.y,window.addEventListener("mousemove",p)}function r(){n=!1,window.removeEventListener("mousemove",p)}function p(i){n&&(a.value.x=i.clientX-l.x,a.value.y=i.clientY-l.y)}return(i,h)=>(c(),v("div",{class:"draggable-window no-select",style:k({left:a.value.x+"px",top:a.value.y+"px"}),onMousedown:f,onMouseup:r,onMouseleave:r},[o("div",{onMousedown:E(f,["stop"])},[ne(i.$slots,"default",{},void 0)],32)],36))}},ge=$(he,[["__scopeId","data-v-5895ea99"]]),ye={key:0,class:"menu"},xe={style:{"margin-top":"10px"}},we=["max"],Me={__name:"colonymenu",props:["showMenu","collected","credits","price"],emits:["update:credits","update:collected"],setup(t,{emit:a}){const n=t,l=a,f=m(1);function r(){const i=n.collected*n.price;l("update:credits",n.credits+i),l("update:collected",0)}function p(){const i=Math.min(f.value,n.collected);l("update:credits",n.credits+i*n.price),l("update:collected",n.collected-i)}return(i,h)=>(c(),L(ge,null,{default:se(()=>[t.showMenu?(c(),v("div",ye,[h[1]||(h[1]=o("h3",null,"Kolonie-Menü",-1)),o("p",null,"Gesammelte Ressourcen: "+y(t.collected),1),o("p",null,"Guthaben: "+y(t.credits)+" Credits",1),o("div",null,[o("button",{onClick:r},"Alle verkaufen ("+y(t.collected)+" × "+y(t.price)+" = "+y(t.collected*t.price)+")",1)]),o("div",xe,[ae(o("input",{"onUpdate:modelValue":h[0]||(h[0]=_=>f.value=_),type:"number",min:"1",max:t.collected,placeholder:"Menge"},null,8,we),[[le,f.value,void 0,{number:!0}]]),o("button",{onClick:p},"Verkaufen")])])):q("",!0)]),_:1}))}},ke=$(Me,[["__scopeId","data-v-36bd4cb4"]]),be={class:"hud"},_e={__name:"colony",setup(t){const a=2e3*window.innerWidth/100,n=1e3*window.innerHeight/100,l=m(5),f=m(0),r=m(2e3),p=m(3e3),i=m(10),h=m(5),_=m(0),T=m(0),A=m(!1),g={x:a/2,y:n/2},z={left:g.x+"px",top:g.y+"px"};function G(){A.value=!A.value}function P(e){f.value=e}function j(e){h.value=e}let U=0;const w=m([]),x=m([]);function R(){return{id:U++,x:Math.random()*a,y:Math.random()*n,taken:!1}}for(let e=0;e<100;e++)w.value.push(R());function B(e,I){return Math.sqrt((e.x-I.x)**2+(e.y-I.y)**2)}async function K(){const e=i.value,u=await(await fetch(`https://randomuser.me/api?nat=DE&results=${e}`)).json();if(u.results&&Array.isArray(u.results))for(let b=0;b<u.results.length;b++){const s=u.results[b];if(s.name&&s.dob&&s.picture){const d=N({id:U++,x:g.x,y:g.y,vx:0,vy:0,target:null,state:"searching",arrived:!0,name:`${s.name.first} ${s.name.last}`,age:s.dob.age,picture:s.picture.medium});x.value.push(d),W(d)}else console.error("Fehlende Daten für einen Unit:",s)}else console.error("Die API gibt keine Ergebnisse zurück oder die Antwort ist kein Array.")}function O(){if(x.value.length>=i.value)return;const e=N({id:U++,x:g.x,y:g.y,vx:0,vy:0,target:null,state:"searching",arrived:!0,name:names[Math.floor(Math.random()*names.length)],age:Math.floor(20+Math.random()*20)});x.value.push(e),W(e)}function W(e){function u(s,d){const M=s.x-e.x,Y=s.y-e.y,S=Math.sqrt(M*M+Y*Y);if(S<1.2){e.x=s.x,e.y=s.y,d();return}e.vx=M/S*1.2,e.vy=Y/S*1.2,e.x+=e.vx,e.y+=e.vy,requestAnimationFrame(()=>u(s,d))}function b(){if(e.state==="searching"){const s=w.value.filter(d=>!d.taken);if(s.length===0)return;s.sort((d,M)=>B(e,d)-B(e,M)),e.target=s[0],e.target.taken=!0,e.state="movingTo",u(e.target,()=>{e.state="mining",setTimeout(()=>{const d=w.value.findIndex(M=>M.id===e.target.id);d!==-1&&w.value.splice(d,1),w.value.push(R()),e.state="returning",b()},p.value)})}else e.state==="returning"&&u(g,()=>{h.value++;const s=x.value.findIndex(d=>d.id===e.id);s!==-1&&x.value.splice(s,1),setTimeout(()=>{e.state="searching",x.value.push(e),W(e)},r.value)})}b()}oe(async()=>{await K(),ie(()=>{_.value=window.innerWidth/2-g.x,T.value=window.innerHeight/2-g.y}),ce(O,r.value)});let H=!1,X,V;function Q(e){H=!0,X=e.clientX,V=e.clientY}function J(){H=!1}function Z(e){H&&(_.value+=e.clientX-X,T.value+=e.clientY-V,X=e.clientX,V=e.clientY)}return(e,I)=>(c(),v(D,null,[o("div",{class:"game-world no-select",onMousedown:Q,onMouseup:J,onMousemove:Z,style:k({transform:`translate(${_.value}px, ${T.value}px)`})},[o("div",{class:"colony",style:z,onClick:E(G,["stop"])}),(c(!0),v(D,null,C(w.value,u=>(c(),v("div",{key:u.id,class:"resource",style:k({left:u.x+"px",top:u.y+"px"})},null,4))),128)),(c(!0),v(D,null,C(x.value,u=>(c(),L(me,{key:u.id,unit:u},null,8,["unit"]))),128))],36),F(fe,{colony:g,resources:w.value,units:x.value,mapWidth:a,mapHeight:n},null,8,["resources","units"]),F(ke,{showMenu:A.value,collected:h.value,credits:f.value,price:l.value,"onUpdate:credits":P,"onUpdate:collected":j},null,8,["showMenu","collected","credits","price"]),o("div",be," Ressourcen gesammelt: "+y(h.value),1)],64))}},De=$(_e,[["__scopeId","data-v-7e31887f"]]);export{De as default};
